---
title: "HW #2"
author: "Andrew Shao"
date: "2024-09-23"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Problem 1

### (a)
$n$ is the number of measurements taken, $Y_{n \times 1}$ is the vector of observed measurements, and $X_{n \times p}$ is the matrix of 1's and 0's corresponding to whether or not each ball was weighed for the measurement.
\[n = 5, 
Y_{n \times 1} = \begin{pmatrix} 2 \\ 1 \\ 4 \\ 2 \\ 2 \end{pmatrix}\,
X_{n \times p} = \begin{pmatrix} 1 & 0 \\ 0 & 1 \\ 1 & 1 \\ 1 & 0 \\ 0 & 1 \end{pmatrix}\]

### (b)
\[(X^T X) = 
\begin{pmatrix} 1 & 0 & 1 & 1 & 0 \\ 0 & 1 & 1 & 0 & 1 \end{pmatrix}
\begin{pmatrix} 1 & 0 \\ 0 & 1 \\ 1 & 1 \\ 1 & 0 \\ 0 & 1 \end{pmatrix}
= \begin{pmatrix} 3 & 1 \\ 1 & 3 \end{pmatrix}\]

\[(X^T X)^{-1} = 
\frac{1}{3 \cdot 3 - 1 \cdot 1}
\begin{pmatrix} 3 & -1 \\ -1 & 3 \end{pmatrix}
=
\begin{pmatrix} \frac{3}{8} & -\frac{1}{8} \\ -\frac{1}{8} & \frac{3}{8} \end{pmatrix} \]

\[X^T Y =
\begin{pmatrix} 1 & 0 & 1 & 1 & 0 \\ 0 & 1 & 1 & 0 & 1 \end{pmatrix}
\begin{pmatrix} 2 \\ 1 \\ 4 \\ 2 \\ 2 \end{pmatrix}
=\begin{pmatrix} 8 \\ 7 \end{pmatrix}\]

### (c)
\[\hat{\beta} = (X^T X)^{-1}X^T Y
=\begin{pmatrix} \frac{3}{8} & -\frac{1}{8} \\ -\frac{1}{8} & \frac{3}{8} \end{pmatrix}
\begin{pmatrix} 8 \\ 7 \end{pmatrix}
= \begin{pmatrix} \frac{17}{8} \\ \frac{13}{8} \end{pmatrix}\]

### (d)
Yes it is the same.

### (e)
\[H = X(X^T X)^{-1} X^T =
\begin{pmatrix} 1 & 0 \\ 0 & 1 \\ 1 & 1 \\ 1 & 0 \\ 0 & 1 \end{pmatrix}
\begin{pmatrix} \frac{3}{8} & -\frac{1}{8} \\ -\frac{1}{8} & \frac{3}{8} \end{pmatrix}
\begin{pmatrix} 1 & 0 & 1 & 1 & 0 \\ 0 & 1 & 1 & 0 & 1 \end{pmatrix} =
\begin{pmatrix} \frac{3}{8} & -\frac{1}{8} & \frac{1}{4} & \frac{3}{8} & -\frac{1}{8} \\
-\frac{1}{8} & \frac{3}{8} & \frac{1}{4} & -\frac{1}{8} & \frac{3}{8} \\
\frac{1}{4} & \frac{1}{4} & \frac{1}{2} & \frac{1}{4} & \frac{1}{4} \\
\frac{3}{8} & -\frac{1}{8} & \frac{1}{4} & \frac{3}{8} & -\frac{1}{8} \\
-\frac{1}{8} & \frac{3}{8}& \frac{1}{4}  & -\frac{1}{8} & \frac{3}{8}
\end{pmatrix}\]

### (f)
\[ \hat{\sigma ^ 2} = \frac{RSS}{n - p} \]
\[ \hat{Y} = HY =
\begin{pmatrix} \frac{3}{8} & -\frac{1}{8} & \frac{1}{4} & \frac{3}{8} & -\frac{1}{8} \\
-\frac{1}{8} & \frac{3}{8} & \frac{1}{4} & -\frac{1}{8} & \frac{3}{8} \\
\frac{1}{4} & \frac{1}{4} & \frac{1}{2} & \frac{1}{4} & \frac{1}{4} \\
\frac{3}{8} & -\frac{1}{8} & \frac{1}{4} & \frac{3}{8} & -\frac{1}{8} \\
-\frac{1}{8} & \frac{3}{8}& \frac{1}{4}  & -\frac{1}{8} & \frac{3}{8} \end{pmatrix}
\begin{pmatrix} 2 \\ 1 \\ 4 \\ 2 \\ 2 \end{pmatrix}\
= \begin{pmatrix} \frac{17}{8} \\ \frac{13}{8} \\ \frac{15}{4} \\ \frac{17}{8} \\ \frac{13}{8} \end{pmatrix}
\]
\[ RSS = \sum_{i} (\epsilon_i)^2 = 
(\epsilon_1)^2 + (\epsilon_2)^2 + (\epsilon_3)^2 + (\epsilon_4)^2 + (\epsilon_5)^2\]
\[ = (\frac{17}{8} - 2)^2 + (\frac{13}{8} - 1)^2 + (\frac{15}{4} - 4)^2 + (\frac{17}{8} - 2)^2 + (\frac{13}{8} - 2)^2 
= \frac{5}{8} \]
\[ \hat{\sigma ^ 2} = \frac{\frac{5}{8}}{5-2} = \frac{5}{24} \]
\[ \hat{\sigma} = \sqrt{\frac{5}{24}} \approx 0.456 \]

```{r, echo=F}
y_1 <- c(2, 1, 4, 2, 2)
a_1 <- c(1, 0, 1, 1, 0)
b_1 <- c(0, 1, 1, 0, 1)

mod_1 <- lm(y_1 ~ a_1 + b_1 -1)
summary(mod_1)
```

## Problem 2
